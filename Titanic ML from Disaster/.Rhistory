# Remove Objects
rm(p1)
rm(p2)
rm(survived)
rm(dead)
rm(entropy)
rm(total)
View(factTable)
AgeGroupSubset <- na.omit(factTable[which(!duplicated(factTable$AgeGroup)), c('AgeGroup', 'PercentageByAgeGroup', 'EntropyByAgeGroup')])
FamilySizeSubset <- na.omit(factTable[which(!duplicated(factTable$FamilySize)), c('FamilySize', 'PercentageByFamilySize', 'EntropyByFamilySize')])
GenderSubset <- na.omit(factTable[which(!duplicated(factTable$Sex)), c('Sex', 'PercentageByGender', 'EntropyByGender')])
ClassSubset <- na.omit(factTable[which(!duplicated(factTable$Pclass)), c('Pclass', 'PercentageByClass', 'EntropyByClass')])
EmbarkSubset <- na.omit(factTable[which(!duplicated(factTable$Embarked)), c('Embarked', 'PercentageByEmbark', 'EntropyByEmbark')])
AgeGroupSubset$InformationGain <- AgeGroupSubset$PercentageByAgeGroup * AgeGroupSubset$EntropyByAgeGroup
FamilySizeSubset$InformationGain <- FamilySizeSubset$PercentageByFamilySize * FamilySizeSubset$EntropyByFamilySize
GenderSubset$InformationGain <- GenderSubset$PercentageByGender * GenderSubset$EntropyByGender
ClassSubset$InformationGain <- ClassSubset$PercentageByClass * ClassSubset$EntropyByClass
EmbarkSubset$InformationGain <- EmbarkSubset$PercentageByEmbark * EmbarkSubset$EntropyByEmbark
View(AgeGroupSubset)
View(FamilySizeSubset)
View(GenderSubset)
View(ClassSubset)
View(EmbarkSubset)
# Libraries
library("ggplot2")
library("ggthemes")
#testData <- read.csv("./Data/test.csv", header = T)
factTable <- read.csv("./Data/train.csv", header = T)
# Begin Segmentation of population
factTable$AgeGroup[factTable$Age <= 18] <- 'CHILD'
factTable$AgeGroup[factTable$Age > 18 & factTable$Age < 65] <- 'ADULT'
factTable$AgeGroup[factTable$Age >= 65] <- 'SENIOR'
factTable$FSize <- factTable$SibSp + factTable$Parch + 1
factTable$FamilySize[factTable$FSize == 1] <- 'SINGLE'
factTable$FamilySize[factTable$FSize > 1 & factTable$FSize <= 4] <- 'SMALL'
factTable$FamilySize[factTable$FSize > 4 & factTable$FSize <= 6] <- 'MEDIUM'
factTable$FamilySize[factTable$FSize > 6] <- 'LARGE'
# Percentage values used for information gain calculation
TotalPassengers <- nrow(factTable)
# Age Group
percentageOfChildren <- length(which(factTable$AgeGroup == 'CHILD'))/TotalPassengers
percentageOfAdults <- length(which(factTable$AgeGroup == 'ADULT'))/TotalPassengers
percentageOfSeniors <- length(which(factTable$AgeGroup == 'SENIOR'))/TotalPassengers
# Family Size
percentageOfSingles <- length(which(factTable$FamilySize == 'SINGLE'))/TotalPassengers
percentageOfSmallFamilies <- length(which(factTable$FamilySize == 'SMALL'))/TotalPassengers
percentageOfMediumFamilies <- length(which(factTable$FamilySize == 'MEDIUM'))/TotalPassengers
percentageOfLargeFamilies <- length(which(factTable$FamilySize == 'LARGE'))/TotalPassengers
# Embark
percentageFromC <- length(which(factTable$Embarked == 'C'))/TotalPassengers
percentageFromQ <- length(which(factTable$Embarked == 'Q'))/TotalPassengers
percentageFromS <- length(which(factTable$Embarked == 'S'))/TotalPassengers
# Gender
percentageFemales <- length(which(factTable$Sex == 'female'))/TotalPassengers
percentageMales <- length(which(factTable$Sex == 'male'))/TotalPassengers
# Class
percentageClass1 <- length(which(factTable$Pclass == 1))/TotalPassengers
percentageClass2 <- length(which(factTable$Pclass == 2))/TotalPassengers
percentageClass3 <- length(which(factTable$Pclass == 3))/TotalPassengers
# Entropy by Age Group
total <- length(which(factTable$AgeGroup == 'CHILD'))
survived <- length(which(factTable$AgeGroup == 'CHILD' & factTable$Survived == 1))
dead <- length(which(factTable$AgeGroup == 'CHILD' & factTable$Survived == 1))
p1 <- survived/total
p2 <- dead/total
entropy <- -(p1*log2(p1) + p2*log2(p2))
factTable$EntropyByAgeGroup[factTable$AgeGroup == 'CHILD'] <- entropy
factTable$PercentageByAgeGroup[factTable$AgeGroup == 'CHILD'] <- percentageOfChildren
total <- length(which(factTable$AgeGroup == 'SENIOR'))
survived <- length(which(factTable$AgeGroup == 'SENIOR' & factTable$Survived == 1))
dead <- length(which(factTable$AgeGroup == 'SENIOR' & factTable$Survived == 0))
p1 <- survived/total
p2 <- dead/total
entropy <- -(p1*log2(p1) + p2*log2(p2))
factTable$EntropyByAgeGroup[factTable$AgeGroup == 'SENIOR'] <- entropy
factTable$PercentageByAgeGroup[factTable$AgeGroup == 'SENIOR'] <- percentageOfSeniors
total <- length(which(factTable$AgeGroup == 'ADULT'))
survived <- length(which(factTable$AgeGroup == 'ADULT' & factTable$Survived == 1))
dead <- length(which(factTable$AgeGroup == 'ADULT' & factTable$Survived == 0))
p1 <- survived/total
p2 <- dead/total
entropy <- -(p1*log2(p1) + p2*log2(p2))
factTable$PercentageByAgeGroup[factTable$AgeGroup == 'ADULT'] <- percentageOfAdults
factTable$EntropyByAgeGroup[factTable$AgeGroup == 'ADULT'] <- entropy
# Entropy by Embark
total <- length(which(factTable$Embarked == 'C'))
survived <- length(which(factTable$Embarked == 'C' & factTable$Survived == 1))
dead <- length(which(factTable$Embarked == 'C' & factTable$Survived == 0))
p1 <- survived/total
p2 <- dead/total
entropy <- -(p1*log2(p1)+p2*log2(p2))
factTable$PercentageByEmbark[factTable$Embarked == 'C'] <- percentageFromC
factTable$EntropyByEmbark[factTable$Embarked == 'C'] <- entropy
total <- length(which(factTable$Embarked == 'S'))
survived <- length(which(factTable$Embarked == 'Q' & factTable$Survived == 1))
dead <- length(which(factTable$Embarked == 'Q' & factTable$Survived == 0))
p1 <- survived/total
p2 <- dead/total
entropy <- -(p1*log2(p1)+p2*log2(p2))
factTable$PercentageByEmbark[factTable$Embarked == 'Q'] <- percentageFromQ
factTable$EntropyByEmbark[factTable$Embarked == 'Q'] <- entropy
total <- length(which(factTable$Embarked == 'S'))
survived <- length(which(factTable$Embarked == 'S' & factTable$Survived == 1))
dead <- length(which(factTable$Embarked == 'S' & factTable$Survived == 0))
p1 <- survived/total
p2 <- dead/total
entropy <- -(p1*log2(p1)+p2*log2(p2))
factTable$PercentageByEmbark[factTable$Embarked == 'S'] <- percentageFromS
factTable$EntropyByEmbark[factTable$Embarked == 'S'] <- entropy
# Entropy by Class
total <- length(which(factTable$Pclass == 1))
survived <- length(which(factTable$Pclass == 1 & factTable$Survived == 1))
dead <- length(which(factTable$Pclass == 1 & factTable$Survived == 0))
p1 <- survived/total
p2 <- dead/total
entropy <- -(p1*log2(p1)+p2*log2(p2))
factTable$PercentageByClass[factTable$Pclass == 1] <- percentageClass1
factTable$EntropyByClass[factTable$Pclass == 1] <- entropy
total <- length(which(factTable$Pclass == 2))
survived <- length(which(factTable$Pclass == 2 & factTable$Survived == 1))
dead <- length(which(factTable$Pclass == 2 & factTable$Survived == 0))
p1 <- survived/total
p2 <- dead/total
entropy <- -(p1*log2(p1)+p2*log2(p2))
factTable$PercentageByClass[factTable$Pclass == 2] <- percentageClass2
factTable$EntropyByClass[factTable$Pclass == 2] <- entropy
total <- length(which(factTable$Pclass == 3))
survived <- length(which(factTable$Pclass == 3 & factTable$Survived == 1))
dead <- length(which(factTable$Pclass == 3 & factTable$Survived == 0))
p1 <- survived/total
p2 <- dead/total
entropy <- -(p1*log2(p1)+p2*log2(p2))
factTable$PercentageByClass[factTable$Pclass == 3] <- percentageClass3
factTable$EntropyByClass[factTable$Pclass == 3] <- entropy
# Entropy by Gender
total <- length(which(factTable$Sex == 'female'))
survived <- length(which(factTable$Sex == 'female' & factTable$Survived == 1))
dead <- length(which(factTable$Sex == 'female' & factTable$Survived == 0))
p1 <- survived/total
p2 <- dead/total
entropy <- -(p1*log2(p1)+p2*log2(p2))
factTable$PercentageByGender[factTable$Sex == 'female'] <- percentageFemales
factTable$EntropyByGender[factTable$Sex == 'female'] <- entropy
total <- length(which(factTable$Sex == 'male'))
survived <- length(which(factTable$Sex == 'male' & factTable$Survived == 1))
dead <- length(which(factTable$Sex == 'male' & factTable$Survived == 0))
p1 <- survived/total
p2 <- dead/total
entropy <- -(p1*log2(p1)+p2*log2(p2))
factTable$PercentageByGender[factTable$Sex == 'male'] <- percentageMales
factTable$EntropyByGender[factTable$Sex == 'male'] <- entropy
# Entropy by Family size
total <- length(which(factTable$FamilySize == 'SINGLE'))
survived <- length(which(factTable$FamilySize == 'SINGLE' & factTable$Survived == 1))
dead <- length(which(factTable$FamilySize == 'SINGLE' & factTable$Survived == 0))
p1 <- survived/total
p2 <- dead/total
entropy <- -(p1*log2(p1)+p2*log2(p2))
factTable$PercentageByFamilySize[factTable$FamilySize == 'SINGLE'] <- percentageOfSingles
factTable$EntropyByFamilySize[factTable$FamilySize == 'SINGLE'] <- entropy
total <- length(which(factTable$FamilySize == 'SMALL'))
survived <- length(which(factTable$FamilySize == 'SMALL' & factTable$Survived == 1))
dead <- length(which(factTable$FamilySize == 'SMALL' & factTable$Survived == 0))
p1 <- survived/total
p2 <- dead/total
entropy <- -(p1*log2(p1)+p2*log2(p2))
factTable$PercentageByFamilySize[factTable$FamilySize == 'SMALL'] <- percentageOfSmallFamilies
factTable$EntropyByFamilySize[factTable$FamilySize == 'SMALL'] <- entropy
total <- length(which(factTable$FamilySize == 'MEDIUM'))
survived <- length(which(factTable$FamilySize == 'MEDIUM' & factTable$Survived == 1))
dead <- length(which(factTable$FamilySize == 'MEDIUM' & factTable$Survived == 0))
p1 <- survived/total
p2 <- dead/total
entropy <- -(p1*log2(p1)+p2*log2(p2))
factTable$PercentageByFamilySize[factTable$FamilySize == 'MEDIUM'] <- percentageOfMediumFamilies
factTable$EntropyByFamilySize[factTable$FamilySize == 'MEDIUM'] <- entropy
total <- length(which(factTable$FamilySize == 'LARGE'))
survived <- length(which(factTable$FamilySize == 'LARGE' & factTable$Survived == 1))
dead <- length(which(factTable$FamilySize == 'LARGE' & factTable$Survived == 0))
p1 <- survived/total
p2 <- dead/total
entropy <- -(p1*log2(p1)+p2*log2(p2))
factTable$PercentageByFamilySize[factTable$FamilySize == 'LARGE'] <- percentageOfLargeFamilies
factTable$EntropyByFamilySize[factTable$Sex == 'LARGE'] <- entropy
#Overall Survival
total <- nrow(factTable)
survived = length(which(factTable$Survived == 1))
dead = length(which(factTable$Survived == 0))
p1 <- survived/total
p2 <- dead/total
entropy <- -(p1*log2(p1) + p2*log2(p2))
factTable$EntropyParentSet <- entropy
# Remove Objects
rm(p1)
rm(p2)
rm(survived)
rm(dead)
rm(entropy)
rm(total)
View(factTable)
AgeGroupSubset <- na.omit(factTable[which(!duplicated(factTable$AgeGroup)), c('AgeGroup', 'PercentageByAgeGroup', 'EntropyByAgeGroup')])
FamilySizeSubset <- na.omit(factTable[which(!duplicated(factTable$FamilySize)), c('FamilySize', 'PercentageByFamilySize', 'EntropyByFamilySize')])
GenderSubset <- na.omit(factTable[which(!duplicated(factTable$Sex)), c('Sex', 'PercentageByGender', 'EntropyByGender')])
ClassSubset <- na.omit(factTable[which(!duplicated(factTable$Pclass)), c('Pclass', 'PercentageByClass', 'EntropyByClass')])
EmbarkSubset <- na.omit(factTable[which(!duplicated(factTable$Embarked)), c('Embarked', 'PercentageByEmbark', 'EntropyByEmbark')])
AgeGroupSubset$InformationGain <- AgeGroupSubset$PercentageByAgeGroup * AgeGroupSubset$EntropyByAgeGroup
FamilySizeSubset$InformationGain <- FamilySizeSubset$PercentageByFamilySize * FamilySizeSubset$EntropyByFamilySize
GenderSubset$InformationGain <- GenderSubset$PercentageByGender * GenderSubset$EntropyByGender
ClassSubset$InformationGain <- ClassSubset$PercentageByClass * ClassSubset$EntropyByClass
EmbarkSubset$InformationGain <- EmbarkSubset$PercentageByEmbark * EmbarkSubset$EntropyByEmbark
# View(AgeGroupSubset)
# View(FamilySizeSubset)
# View(GenderSubset)
# View(ClassSubset)
# View(EmbarkSubset)
IG_AgeGroup <- sum(AgeGroupSubset$InformationGain)
IG_FamilySize <- sum(FamilySizeSubset$InformationGain)
IG_Gender <- sum(GenderSubset$InformationGain)
IG_Class <- sum(ClassSubset$InformationGain)
IG_Embark <- sum(EmbarkSubset$InformationGain)
FinalEntropyParent <- factTable$EntropyParentSet - IG_AgeGroup - IG_FamilySize - IG_Gender - IG_Class - IG_Embark
# Libraries
library("ggplot2")
library("ggthemes")
#testData <- read.csv("./Data/test.csv", header = T)
factTable <- read.csv("./Data/train.csv", header = T)
# Begin Segmentation of population
factTable$AgeGroup[factTable$Age <= 18] <- 'CHILD'
factTable$AgeGroup[factTable$Age > 18 & factTable$Age < 65] <- 'ADULT'
factTable$AgeGroup[factTable$Age >= 65] <- 'SENIOR'
factTable$FSize <- factTable$SibSp + factTable$Parch + 1
factTable$FamilySize[factTable$FSize == 1] <- 'SINGLE'
factTable$FamilySize[factTable$FSize > 1 & factTable$FSize <= 4] <- 'SMALL'
factTable$FamilySize[factTable$FSize > 4 & factTable$FSize <= 6] <- 'MEDIUM'
factTable$FamilySize[factTable$FSize > 6] <- 'LARGE'
# Percentage values used for information gain calculation
TotalPassengers <- nrow(factTable)
# Age Group
percentageOfChildren <- length(which(factTable$AgeGroup == 'CHILD'))/TotalPassengers
percentageOfAdults <- length(which(factTable$AgeGroup == 'ADULT'))/TotalPassengers
percentageOfSeniors <- length(which(factTable$AgeGroup == 'SENIOR'))/TotalPassengers
# Family Size
percentageOfSingles <- length(which(factTable$FamilySize == 'SINGLE'))/TotalPassengers
percentageOfSmallFamilies <- length(which(factTable$FamilySize == 'SMALL'))/TotalPassengers
percentageOfMediumFamilies <- length(which(factTable$FamilySize == 'MEDIUM'))/TotalPassengers
percentageOfLargeFamilies <- length(which(factTable$FamilySize == 'LARGE'))/TotalPassengers
# Embark
percentageFromC <- length(which(factTable$Embarked == 'C'))/TotalPassengers
percentageFromQ <- length(which(factTable$Embarked == 'Q'))/TotalPassengers
percentageFromS <- length(which(factTable$Embarked == 'S'))/TotalPassengers
# Gender
percentageFemales <- length(which(factTable$Sex == 'female'))/TotalPassengers
percentageMales <- length(which(factTable$Sex == 'male'))/TotalPassengers
# Class
percentageClass1 <- length(which(factTable$Pclass == 1))/TotalPassengers
percentageClass2 <- length(which(factTable$Pclass == 2))/TotalPassengers
percentageClass3 <- length(which(factTable$Pclass == 3))/TotalPassengers
# Entropy by Age Group
total <- length(which(factTable$AgeGroup == 'CHILD'))
survived <- length(which(factTable$AgeGroup == 'CHILD' & factTable$Survived == 1))
dead <- length(which(factTable$AgeGroup == 'CHILD' & factTable$Survived == 1))
p1 <- survived/total
p2 <- dead/total
entropy <- -(p1*log2(p1) + p2*log2(p2))
factTable$EntropyByAgeGroup[factTable$AgeGroup == 'CHILD'] <- entropy
factTable$PercentageByAgeGroup[factTable$AgeGroup == 'CHILD'] <- percentageOfChildren
total <- length(which(factTable$AgeGroup == 'SENIOR'))
survived <- length(which(factTable$AgeGroup == 'SENIOR' & factTable$Survived == 1))
dead <- length(which(factTable$AgeGroup == 'SENIOR' & factTable$Survived == 0))
p1 <- survived/total
p2 <- dead/total
entropy <- -(p1*log2(p1) + p2*log2(p2))
factTable$EntropyByAgeGroup[factTable$AgeGroup == 'SENIOR'] <- entropy
factTable$PercentageByAgeGroup[factTable$AgeGroup == 'SENIOR'] <- percentageOfSeniors
total <- length(which(factTable$AgeGroup == 'ADULT'))
survived <- length(which(factTable$AgeGroup == 'ADULT' & factTable$Survived == 1))
dead <- length(which(factTable$AgeGroup == 'ADULT' & factTable$Survived == 0))
p1 <- survived/total
p2 <- dead/total
entropy <- -(p1*log2(p1) + p2*log2(p2))
factTable$PercentageByAgeGroup[factTable$AgeGroup == 'ADULT'] <- percentageOfAdults
factTable$EntropyByAgeGroup[factTable$AgeGroup == 'ADULT'] <- entropy
# Entropy by Embark
total <- length(which(factTable$Embarked == 'C'))
survived <- length(which(factTable$Embarked == 'C' & factTable$Survived == 1))
dead <- length(which(factTable$Embarked == 'C' & factTable$Survived == 0))
p1 <- survived/total
p2 <- dead/total
entropy <- -(p1*log2(p1)+p2*log2(p2))
factTable$PercentageByEmbark[factTable$Embarked == 'C'] <- percentageFromC
factTable$EntropyByEmbark[factTable$Embarked == 'C'] <- entropy
total <- length(which(factTable$Embarked == 'S'))
survived <- length(which(factTable$Embarked == 'Q' & factTable$Survived == 1))
dead <- length(which(factTable$Embarked == 'Q' & factTable$Survived == 0))
p1 <- survived/total
p2 <- dead/total
entropy <- -(p1*log2(p1)+p2*log2(p2))
factTable$PercentageByEmbark[factTable$Embarked == 'Q'] <- percentageFromQ
factTable$EntropyByEmbark[factTable$Embarked == 'Q'] <- entropy
total <- length(which(factTable$Embarked == 'S'))
survived <- length(which(factTable$Embarked == 'S' & factTable$Survived == 1))
dead <- length(which(factTable$Embarked == 'S' & factTable$Survived == 0))
p1 <- survived/total
p2 <- dead/total
entropy <- -(p1*log2(p1)+p2*log2(p2))
factTable$PercentageByEmbark[factTable$Embarked == 'S'] <- percentageFromS
factTable$EntropyByEmbark[factTable$Embarked == 'S'] <- entropy
# Entropy by Class
total <- length(which(factTable$Pclass == 1))
survived <- length(which(factTable$Pclass == 1 & factTable$Survived == 1))
dead <- length(which(factTable$Pclass == 1 & factTable$Survived == 0))
p1 <- survived/total
p2 <- dead/total
entropy <- -(p1*log2(p1)+p2*log2(p2))
factTable$PercentageByClass[factTable$Pclass == 1] <- percentageClass1
factTable$EntropyByClass[factTable$Pclass == 1] <- entropy
total <- length(which(factTable$Pclass == 2))
survived <- length(which(factTable$Pclass == 2 & factTable$Survived == 1))
dead <- length(which(factTable$Pclass == 2 & factTable$Survived == 0))
p1 <- survived/total
p2 <- dead/total
entropy <- -(p1*log2(p1)+p2*log2(p2))
factTable$PercentageByClass[factTable$Pclass == 2] <- percentageClass2
factTable$EntropyByClass[factTable$Pclass == 2] <- entropy
total <- length(which(factTable$Pclass == 3))
survived <- length(which(factTable$Pclass == 3 & factTable$Survived == 1))
dead <- length(which(factTable$Pclass == 3 & factTable$Survived == 0))
p1 <- survived/total
p2 <- dead/total
entropy <- -(p1*log2(p1)+p2*log2(p2))
factTable$PercentageByClass[factTable$Pclass == 3] <- percentageClass3
factTable$EntropyByClass[factTable$Pclass == 3] <- entropy
# Entropy by Gender
total <- length(which(factTable$Sex == 'female'))
survived <- length(which(factTable$Sex == 'female' & factTable$Survived == 1))
dead <- length(which(factTable$Sex == 'female' & factTable$Survived == 0))
p1 <- survived/total
p2 <- dead/total
entropy <- -(p1*log2(p1)+p2*log2(p2))
factTable$PercentageByGender[factTable$Sex == 'female'] <- percentageFemales
factTable$EntropyByGender[factTable$Sex == 'female'] <- entropy
total <- length(which(factTable$Sex == 'male'))
survived <- length(which(factTable$Sex == 'male' & factTable$Survived == 1))
dead <- length(which(factTable$Sex == 'male' & factTable$Survived == 0))
p1 <- survived/total
p2 <- dead/total
entropy <- -(p1*log2(p1)+p2*log2(p2))
factTable$PercentageByGender[factTable$Sex == 'male'] <- percentageMales
factTable$EntropyByGender[factTable$Sex == 'male'] <- entropy
# Entropy by Family size
total <- length(which(factTable$FamilySize == 'SINGLE'))
survived <- length(which(factTable$FamilySize == 'SINGLE' & factTable$Survived == 1))
dead <- length(which(factTable$FamilySize == 'SINGLE' & factTable$Survived == 0))
p1 <- survived/total
p2 <- dead/total
entropy <- -(p1*log2(p1)+p2*log2(p2))
factTable$PercentageByFamilySize[factTable$FamilySize == 'SINGLE'] <- percentageOfSingles
factTable$EntropyByFamilySize[factTable$FamilySize == 'SINGLE'] <- entropy
total <- length(which(factTable$FamilySize == 'SMALL'))
survived <- length(which(factTable$FamilySize == 'SMALL' & factTable$Survived == 1))
dead <- length(which(factTable$FamilySize == 'SMALL' & factTable$Survived == 0))
p1 <- survived/total
p2 <- dead/total
entropy <- -(p1*log2(p1)+p2*log2(p2))
factTable$PercentageByFamilySize[factTable$FamilySize == 'SMALL'] <- percentageOfSmallFamilies
factTable$EntropyByFamilySize[factTable$FamilySize == 'SMALL'] <- entropy
total <- length(which(factTable$FamilySize == 'MEDIUM'))
survived <- length(which(factTable$FamilySize == 'MEDIUM' & factTable$Survived == 1))
dead <- length(which(factTable$FamilySize == 'MEDIUM' & factTable$Survived == 0))
p1 <- survived/total
p2 <- dead/total
entropy <- -(p1*log2(p1)+p2*log2(p2))
factTable$PercentageByFamilySize[factTable$FamilySize == 'MEDIUM'] <- percentageOfMediumFamilies
factTable$EntropyByFamilySize[factTable$FamilySize == 'MEDIUM'] <- entropy
total <- length(which(factTable$FamilySize == 'LARGE'))
survived <- length(which(factTable$FamilySize == 'LARGE' & factTable$Survived == 1))
dead <- length(which(factTable$FamilySize == 'LARGE' & factTable$Survived == 0))
p1 <- survived/total
p2 <- dead/total
entropy <- -(p1*log2(p1)+p2*log2(p2))
factTable$PercentageByFamilySize[factTable$FamilySize == 'LARGE'] <- percentageOfLargeFamilies
factTable$EntropyByFamilySize[factTable$Sex == 'LARGE'] <- entropy
#Overall Survival
total <- nrow(factTable)
survived = length(which(factTable$Survived == 1))
dead = length(which(factTable$Survived == 0))
p1 <- survived/total
p2 <- dead/total
entropy <- -(p1*log2(p1) + p2*log2(p2))
factTable$EntropyParentSet <- entropy
# Remove Objects
rm(p1)
rm(p2)
rm(survived)
rm(dead)
rm(entropy)
rm(total)
View(factTable)
AgeGroupSubset <- na.omit(factTable[which(!duplicated(factTable$AgeGroup)), c('AgeGroup', 'PercentageByAgeGroup', 'EntropyByAgeGroup')])
FamilySizeSubset <- na.omit(factTable[which(!duplicated(factTable$FamilySize)), c('FamilySize', 'PercentageByFamilySize', 'EntropyByFamilySize')])
GenderSubset <- na.omit(factTable[which(!duplicated(factTable$Sex)), c('Sex', 'PercentageByGender', 'EntropyByGender')])
ClassSubset <- na.omit(factTable[which(!duplicated(factTable$Pclass)), c('Pclass', 'PercentageByClass', 'EntropyByClass')])
EmbarkSubset <- na.omit(factTable[which(!duplicated(factTable$Embarked)), c('Embarked', 'PercentageByEmbark', 'EntropyByEmbark')])
AgeGroupSubset$InformationGain <- AgeGroupSubset$PercentageByAgeGroup * AgeGroupSubset$EntropyByAgeGroup
FamilySizeSubset$InformationGain <- FamilySizeSubset$PercentageByFamilySize * FamilySizeSubset$EntropyByFamilySize
GenderSubset$InformationGain <- GenderSubset$PercentageByGender * GenderSubset$EntropyByGender
ClassSubset$InformationGain <- ClassSubset$PercentageByClass * ClassSubset$EntropyByClass
EmbarkSubset$InformationGain <- EmbarkSubset$PercentageByEmbark * EmbarkSubset$EntropyByEmbark
# View(AgeGroupSubset)
# View(FamilySizeSubset)
# View(GenderSubset)
# View(ClassSubset)
# View(EmbarkSubset)
IG_AgeGroup <- sum(AgeGroupSubset$InformationGain)
IG_FamilySize <- sum(FamilySizeSubset$InformationGain)
IG_Gender <- sum(GenderSubset$InformationGain)
IG_Class <- sum(ClassSubset$InformationGain)
IG_Embark <- sum(EmbarkSubset$InformationGain)
FinalEntropyParent <- factTable$EntropyParentSet - IG_AgeGroup - IG_FamilySize - IG_Gender - IG_Class - IG_Embark
factTable$EntropyParentSetAfter <- FinalEntropyParent
AgeGroupSubset <- na.omit(factTable[which(!duplicated(factTable$AgeGroup)), c('AgeGroup', 'PercentageByAgeGroup', 'EntropyByAgeGroup')])
FamilySizeSubset <- na.omit(factTable[which(!duplicated(factTable$FamilySize)), c('FamilySize', 'PercentageByFamilySize', 'EntropyByFamilySize')])
GenderSubset <- na.omit(factTable[which(!duplicated(factTable$Sex)), c('Sex', 'PercentageByGender', 'EntropyByGender')])
ClassSubset <- na.omit(factTable[which(!duplicated(factTable$Pclass)), c('Pclass', 'PercentageByClass', 'EntropyByClass')])
EmbarkSubset <- na.omit(factTable[which(!duplicated(factTable$Embarked)), c('Embarked', 'PercentageByEmbark', 'EntropyByEmbark')])
AgeGroupSubset$InformationGain <- AgeGroupSubset$PercentageByAgeGroup * AgeGroupSubset$EntropyByAgeGroup
FamilySizeSubset$InformationGain <- FamilySizeSubset$PercentageByFamilySize * FamilySizeSubset$EntropyByFamilySize
GenderSubset$InformationGain <- GenderSubset$PercentageByGender * GenderSubset$EntropyByGender
ClassSubset$InformationGain <- ClassSubset$PercentageByClass * ClassSubset$EntropyByClass
EmbarkSubset$InformationGain <- EmbarkSubset$PercentageByEmbark * EmbarkSubset$EntropyByEmbark
# View(AgeGroupSubset)
# View(FamilySizeSubset)
# View(GenderSubset)
# View(ClassSubset)
# View(EmbarkSubset)
IG_AgeGroup <- sum(AgeGroupSubset$InformationGain)
IG_FamilySize <- sum(FamilySizeSubset$InformationGain)
IG_Gender <- sum(GenderSubset$InformationGain)
IG_Class <- sum(ClassSubset$InformationGain)
IG_Embark <- sum(EmbarkSubset$InformationGain)
FinalEntropyParent <- factTable$EntropyParentSet - IG_AgeGroup - IG_FamilySize - IG_Gender - IG_Class - IG_Embark
factTable$EntropyParentSetAfter <- FinalEntropyParent
View(factTable)
AgeGroupSubset <- na.omit(factTable[which(!duplicated(factTable$AgeGroup)), c('AgeGroup', 'PercentageByAgeGroup', 'EntropyByAgeGroup')])
FamilySizeSubset <- na.omit(factTable[which(!duplicated(factTable$FamilySize)), c('FamilySize', 'PercentageByFamilySize', 'EntropyByFamilySize')])
GenderSubset <- na.omit(factTable[which(!duplicated(factTable$Sex)), c('Sex', 'PercentageByGender', 'EntropyByGender')])
ClassSubset <- na.omit(factTable[which(!duplicated(factTable$Pclass)), c('Pclass', 'PercentageByClass', 'EntropyByClass')])
EmbarkSubset <- na.omit(factTable[which(!duplicated(factTable$Embarked)), c('Embarked', 'PercentageByEmbark', 'EntropyByEmbark')])
AgeGroupSubset$InformationGain <- AgeGroupSubset$PercentageByAgeGroup * AgeGroupSubset$EntropyByAgeGroup
FamilySizeSubset$InformationGain <- FamilySizeSubset$PercentageByFamilySize * FamilySizeSubset$EntropyByFamilySize
GenderSubset$InformationGain <- GenderSubset$PercentageByGender * GenderSubset$EntropyByGender
ClassSubset$InformationGain <- ClassSubset$PercentageByClass * ClassSubset$EntropyByClass
EmbarkSubset$InformationGain <- EmbarkSubset$PercentageByEmbark * EmbarkSubset$EntropyByEmbark
# View(AgeGroupSubset)
# View(FamilySizeSubset)
# View(GenderSubset)
# View(ClassSubset)
# View(EmbarkSubset)
IG_AgeGroup <- sum(AgeGroupSubset$InformationGain)
IG_FamilySize <- sum(FamilySizeSubset$InformationGain)
IG_Gender <- sum(GenderSubset$InformationGain)
IG_Class <- sum(ClassSubset$InformationGain)
IG_Embark <- sum(EmbarkSubset$InformationGain)
FinalEntropyParent <- factTable$EntropyParentSet - IG_AgeGroup - IG_FamilySize - IG_Gender - IG_Class
factTable$EntropyParentSetAfter <- FinalEntropyParent
View(factTable)
AgeGroupSubset <- na.omit(factTable[which(!duplicated(factTable$AgeGroup)), c('AgeGroup', 'PercentageByAgeGroup', 'EntropyByAgeGroup')])
FamilySizeSubset <- na.omit(factTable[which(!duplicated(factTable$FamilySize)), c('FamilySize', 'PercentageByFamilySize', 'EntropyByFamilySize')])
GenderSubset <- na.omit(factTable[which(!duplicated(factTable$Sex)), c('Sex', 'PercentageByGender', 'EntropyByGender')])
ClassSubset <- na.omit(factTable[which(!duplicated(factTable$Pclass)), c('Pclass', 'PercentageByClass', 'EntropyByClass')])
EmbarkSubset <- na.omit(factTable[which(!duplicated(factTable$Embarked)), c('Embarked', 'PercentageByEmbark', 'EntropyByEmbark')])
AgeGroupSubset$InformationGain <- AgeGroupSubset$PercentageByAgeGroup * AgeGroupSubset$EntropyByAgeGroup
FamilySizeSubset$InformationGain <- FamilySizeSubset$PercentageByFamilySize * FamilySizeSubset$EntropyByFamilySize
GenderSubset$InformationGain <- GenderSubset$PercentageByGender * GenderSubset$EntropyByGender
ClassSubset$InformationGain <- ClassSubset$PercentageByClass * ClassSubset$EntropyByClass
EmbarkSubset$InformationGain <- EmbarkSubset$PercentageByEmbark * EmbarkSubset$EntropyByEmbark
# View(AgeGroupSubset)
# View(FamilySizeSubset)
# View(GenderSubset)
# View(ClassSubset)
# View(EmbarkSubset)
IG_AgeGroup <- sum(AgeGroupSubset$InformationGain)
IG_FamilySize <- sum(FamilySizeSubset$InformationGain)
IG_Gender <- sum(GenderSubset$InformationGain)
IG_Class <- sum(ClassSubset$InformationGain)
IG_Embark <- sum(EmbarkSubset$InformationGain)
FinalEntropyParent <- factTable$EntropyParentSet - IG_AgeGroup - IG_FamilySize - IG_Gender
factTable$EntropyParentSetAfter <- FinalEntropyParent
View(factTable)
AgeGroupSubset <- na.omit(factTable[which(!duplicated(factTable$AgeGroup)), c('AgeGroup', 'PercentageByAgeGroup', 'EntropyByAgeGroup')])
FamilySizeSubset <- na.omit(factTable[which(!duplicated(factTable$FamilySize)), c('FamilySize', 'PercentageByFamilySize', 'EntropyByFamilySize')])
GenderSubset <- na.omit(factTable[which(!duplicated(factTable$Sex)), c('Sex', 'PercentageByGender', 'EntropyByGender')])
ClassSubset <- na.omit(factTable[which(!duplicated(factTable$Pclass)), c('Pclass', 'PercentageByClass', 'EntropyByClass')])
EmbarkSubset <- na.omit(factTable[which(!duplicated(factTable$Embarked)), c('Embarked', 'PercentageByEmbark', 'EntropyByEmbark')])
AgeGroupSubset$InformationGain <- AgeGroupSubset$PercentageByAgeGroup * AgeGroupSubset$EntropyByAgeGroup
FamilySizeSubset$InformationGain <- FamilySizeSubset$PercentageByFamilySize * FamilySizeSubset$EntropyByFamilySize
GenderSubset$InformationGain <- GenderSubset$PercentageByGender * GenderSubset$EntropyByGender
ClassSubset$InformationGain <- ClassSubset$PercentageByClass * ClassSubset$EntropyByClass
EmbarkSubset$InformationGain <- EmbarkSubset$PercentageByEmbark * EmbarkSubset$EntropyByEmbark
# View(AgeGroupSubset)
# View(FamilySizeSubset)
# View(GenderSubset)
# View(ClassSubset)
# View(EmbarkSubset)
IG_AgeGroup <- sum(AgeGroupSubset$InformationGain)
IG_FamilySize <- sum(FamilySizeSubset$InformationGain)
IG_Gender <- sum(GenderSubset$InformationGain)
IG_Class <- sum(ClassSubset$InformationGain)
IG_Embark <- sum(EmbarkSubset$InformationGain)
FinalEntropyParent <- factTable$EntropyParentSet - IG_AgeGroup - IG_FamilySize - IG_Gender - IG_Class - IG_Embark
factTable$EntropyParentSetAfter <- FinalEntropyParent
View(factTable)
